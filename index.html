<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VanderTeam | فاندر تيم</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>

    <header id="main-header">
        <div class="header-content">
            <nav>
                <button onclick="showSection('home-view')">الرئيسية</button>
                <button onclick="checkAdminStatus()">لوحة الأدمن</button>
            </nav>
        </div>
    </header>

    <main class="container">
        <div id="loading-overlay" class="hidden-section">
            <div class="spinner"></div>
            <p>جارٍ معالجة طلبك...</p>
        </div>

        <section id="home-view" class="active-section">
            <div class="search-bar">
                <input type="text" id="search-input" placeholder="بحث عن مانجا..." onkeyup="filterManga()">
            </div>
            <h2 class="section-title">آخر التحديثات</h2>
            <div id="manga-grid" class="grid-container"></div>
        </section>

        <section id="login-view" class="hidden-section">
            <div class="login-box">
                <h2>دخول المشرفين</h2>
                <input type="text" id="username" placeholder="اسم المستخدم">
                <input type="password" id="password" placeholder="كلمة المرور">
                <button onclick="login()">دخول</button>
            </div>
        </section>

        <section id="admin-dashboard" class="hidden-section">
            <div class="admin-header">
                <h2>لوحة التحكم</h2>
                <button class="logout-btn" onclick="logout()">تسجيل خروج</button>
            </div>
            <div class="admin-tabs">
                <button onclick="showAdminTab('add-panel')" id="btn-tab-1" class="active-tab">إضافة</button>
                <button onclick="showAdminTab('manage-panel')" id="btn-tab-2">إدارة وحذف</button>
            </div>

            <div id="add-panel" class="admin-content">
                <h3>إضافة مانجا</h3>
                <input type="text" id="manga-title" placeholder="اسم المانجا">
                <textarea id="manga-desc" placeholder="الوصف"></textarea>
                <input type="file" id="manga-cover" accept="image/*">
                <button onclick="addNewManga()" class="action-btn">حفظ أونلاين</button>
                <hr>
                <h3>إضافة فصل</h3>
                <select id="manga-select-add"></select>
                <input type="text" id="chapter-title" placeholder="رقم الفصل">
                <input type="file" id="chapter-file" accept="application/pdf">
                <button onclick="addChapter()" class="action-btn">رفع الفصل</button>
            </div>

            <div id="manage-panel" class="admin-content hidden-tab">
                <h3>إدارة المحتوى</h3>
                <select id="manga-select-manage" onchange="loadMangaToEdit()"></select>
                <div id="edit-box" class="hidden-section">
                    <input type="text" id="edit-manga-title">
                    <textarea id="edit-manga-desc"></textarea>
                    <button onclick="updateManga()" class="action-btn">تحديث</button>
                    <button onclick="deleteManga()" class="action-btn delete-btn">حذف نهائي</button>
                    <ul id="edit-chapters-list"></ul>
                </div>
            </div>
        </section>

        <section id="manga-details-view" class="hidden-section">
            <button onclick="showSection('home-view')" class="back-btn">← عودة</button>
            <div class="manga-layout">
                <div class="manga-info-card">
                    <img id="detail-cover" src="">
                    <h1 id="detail-title"></h1>
                    <p id="detail-desc"></p>
                </div>
                <div class="chapters-list-container">
                    <h3>قائمة الفصول</h3>
                    <ul id="chapters-list"></ul>
                </div>
            </div>
        </section>

        <section id="reader-view" class="hidden-section">
            <div class="reader-header">
                <button onclick="backToManga()" class="back-btn">إغلاق</button>
                <span id="reader-chapter-title"></span>
            </div>
            <div id="pdf-viewer-container"></div>
        </section>
    </main>

    <script src="script.js"></script>
</body>
</html>